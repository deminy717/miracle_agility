<view class="course-manage-page">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">ğŸ“š è¯¾ç¨‹ç®¡ç†</text>
    <text class="page-subtitle">ç®¡ç†æ‰€æœ‰è¯¾ç¨‹å†…å®¹</text>
  </view>

  <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
  <view class="stats-overview">
    <view class="stat-card">
      <text class="stat-number">{{stats.total}}</text>
      <text class="stat-label">æ€»è¯¾ç¨‹æ•°</text>
    </view>
    <view class="stat-card">
      <text class="stat-number">{{stats.published}}</text>
      <text class="stat-label">å·²å‘å¸ƒ</text>
    </view>
    <view class="stat-card">
      <text class="stat-number">{{stats.draft}}</text>
      <text class="stat-label">è‰ç¨¿</text>
    </view>
  </view>

  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="search-section">
    <view class="search-box">
      <input 
        class="search-input" 
        placeholder="æœç´¢è¯¾ç¨‹åç§°..." 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
      />
      <text class="search-icon">ğŸ”</text>
    </view>
    <picker 
      class="filter-picker" 
      bindchange="onStatusFilter" 
      value="{{statusIndex}}" 
      range="{{statusOptions}}"
    >
      <view class="picker-text">{{statusOptions[statusIndex]}}</view>
    </picker>
  </view>

  <!-- è¯¾ç¨‹åˆ—è¡¨ -->
  <view class="courses-list">
    <view 
      class="course-item" 
      wx:for="{{filteredCourses}}" 
      wx:key="id"
      bindtap="viewCourse"
      data-course="{{item}}"
    >
      <view class="course-cover">
        <image src="{{item.cover}}" mode="aspectFill" />
        <view class="course-status status-{{item.status}}">
          {{item.status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿'}}
        </view>
      </view>
      
      <view class="course-info">
        <text class="course-title">{{item.title}}</text>
        <text class="course-description">{{item.description}}</text>
        <view class="course-meta">
          <text class="meta-item">â° {{item.updateTime}}</text>
        </view>
      </view>
      
      <view class="course-actions">
        <view class="action-btn edit-btn" catchtap="editCourse" data-id="{{item.id}}">
          <text class="btn-text">ç¼–è¾‘è¯¾ç¨‹</text>
        </view>
        <view class="action-btn chapter-btn" catchtap="manageChapters" data-id="{{item.id}}">
          <text class="btn-text">ç¼–è¾‘ç« èŠ‚</text>
        </view>
        <view class="switch-container" catchtap="toggleStatus" data-id="{{item.id}}">
          <view class="switch {{item.status === 'published' ? 'switch-on' : 'switch-off'}}">
            <view class="switch-handle"></view>
          </view>
        </view>
        <view class="action-btn delete-btn" catchtap="deleteCourse" data-id="{{item.id}}">
          <text class="btn-text">åˆ é™¤è¯¾ç¨‹</text>
        </view>
        <view class="action-btn code-btn" catchtap="manageAccessCodes" data-id="{{item.id}}" data-title="{{item.title}}">
          <text class="btn-text">æˆæƒç </text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{filteredCourses.length === 0}}">
    <text class="empty-icon">ğŸ“š</text>
    <text class="empty-text">æš‚æ— è¯¾ç¨‹æ•°æ®</text>
    <text class="empty-tip">ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä¸ªè¯¾ç¨‹</text>
  </view>

  <!-- æµ®åŠ¨æ·»åŠ æŒ‰é’® -->
  <view class="fab-button" bindtap="createCourse">
    <text class="fab-icon">+</text>
  </view>
</view>

<!-- è¯¾ç¨‹æœ‰æ•ˆæœŸé€‰æ‹©å™¨å¼¹çª— -->
<view class="validity-picker-modal {{showValidityPicker ? 'show' : ''}}" catchtap="hideValidityPicker">
  <view class="modal-content" catchtap="stopPropagation">
    <!-- å¼¹çª—æ ‡é¢˜ -->
    <view class="modal-header">
      <text class="modal-title">ğŸ¯ é€‰æ‹©è¯¾ç¨‹æœ‰æ•ˆæœŸ</text>
      <view class="close-btn" bindtap="hideValidityPicker">âœ•</view>
    </view>
    
    <!-- è¯¾ç¨‹ä¿¡æ¯ -->
    <view class="course-info">
      <text class="course-title">è¯¾ç¨‹ï¼š{{selectedCourseTitle}}</text>
      <text class="course-tip">é€šè¿‡æˆæƒç è·å¾—çš„è¯¾ç¨‹è®¿é—®æƒé™æœ‰æ•ˆæ—¶é—´</text>
    </view>
    
    <!-- ä¸‹æ‹‰é€‰æ‹©å™¨ -->
    <view class="picker-container">
      <picker 
        mode="selector" 
        range="{{validityOptions}}" 
        range-key="displayName"
        value="{{selectedValidityIndex}}" 
        bindchange="onValidityChange"
        class="validity-picker">
        <view class="picker-display">
          <text class="picker-text">{{validityOptions[selectedValidityIndex].displayName}}</text>
          <text class="picker-arrow">â–¼</text>
        </view>
      </picker>
    </view>
    
    <!-- é€‰æ‹©è¯´æ˜ -->
    <view class="selection-info">
      <view class="info-item">
        <text class="info-label">è¯¾ç¨‹æƒé™ï¼š</text>
        <text class="info-value">{{validityOptions[selectedValidityIndex].displayText}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æˆæƒç æœ‰æ•ˆæœŸï¼š</text>
        <text class="info-value">24å°æ—¶</text>
      </view>
      <view class="info-item">
        <text class="info-label">ä½¿ç”¨æ¬¡æ•°ï¼š</text>
        <text class="info-value">1æ¬¡</text>
      </view>
    </view>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="modal-footer">
      <button class="btn-cancel" bindtap="hideValidityPicker">å–æ¶ˆ</button>
      <button class="btn-confirm" bindtap="confirmGenerateCode">ç«‹å³ç”Ÿæˆ</button>
    </view>
  </view>
</view>