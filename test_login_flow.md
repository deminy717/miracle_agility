# 登录流程测试指南

## 🧪 测试场景

### 场景1：新用户登录
**期望流程**：
1. 用户点击"微信一键登录"
2. 前端调用后端API（不传userInfo）
3. 后端返回"用户不存在，需要提供用户信息进行注册"
4. 前端识别为新用户错误，显示头像昵称填写表单
5. 用户填写头像昵称后确认
6. 前端调用后端API（传userInfo）
7. 后端创建新用户并返回登录成功

### 场景2：老用户登录
**期望流程**：
1. 用户点击"微信一键登录"  
2. 前端调用后端API（不传userInfo）
3. 后端找到已存在用户，直接返回登录成功
4. 前端保存登录信息，进入已登录状态

## 🔍 调试信息关键点

### 新用户登录调试日志：
```
🔄 尝试直接登录...
⚠️ 直接登录失败: 用户不存在，需要提供用户信息进行注册
🔍 分析错误信息: 用户不存在，需要提供用户信息进行注册
✅ 匹配到新用户模式: 用户不存在
👤 检测到新用户，显示信息填写表单
📝 显示头像昵称填写表单
```

### 老用户登录调试日志：
```
🔄 尝试直接登录...
✅ 直接登录成功（老用户）
✅ 登录成功 - 用户: 用户昵称
```

## 📝 测试步骤

1. **清除本地存储**：确保测试环境干净
2. **测试新用户**：首次登录应该显示头像昵称表单
3. **完成注册**：填写信息后成功登录
4. **退出登录**：清除登录状态
5. **测试老用户**：再次登录应该直接成功，不显示表单

## 🐛 常见问题

- 如果一直显示头像昵称表单：检查错误匹配逻辑
- 如果直接进入模拟登录：检查网络连接或API调用
- 如果显示其他错误：查看具体错误信息，可能是服务器问题 