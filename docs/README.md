# Miracle Agility 项目文档中心

欢迎来到 Miracle Agility（奇迹犬敏捷）项目文档中心。这里包含了项目的所有技术文档、功能说明和开发指南。

## 文档概览

本项目是一个专注于犬类敏捷训练的微信小程序，为用户提供课程学习、资讯阅读、内容发布等功能。文档分为以下几个主要部分：

## 📁 文档目录

### 🏗️ 项目架构文档
- **[项目结构文档](./project-structure.md)** - 完整的项目目录结构和文件说明
- **[技术架构文档](./technical-architecture.md)** - 系统架构设计、技术选型和扩展规划
- **[数据库设计文档](./database-schema.md)** - MySQL数据库表结构和设计规范

### 🔧 功能文档
- **[功能文档](./feature-documentation.md)** - 详细的功能模块说明和操作流程
- **[API接口文档](./api-documentation.md)** - 完整的API接口规范和调用示例
- **[用户登录功能指南](./user-login-guide.md)** - 微信小程序登录认证系统完整实现指南

### 📋 需求和规范
- **[需求文档](./requirements.md)** - 项目需求和功能规格说明
- **[环境配置文档](./environment-config.md)** - 开发环境配置指南

### 🛠️ 开发指南
- **[管理系统指南](./admin-system-guide.md)** - 管理员功能使用指南
- **[本地前后端调试指南](./local-debug-guide.md)** - 本地开发环境搭建和调试方法
- **[故障排除指南](./troubleshooting-guide.md)** - 常见问题诊断和解决方案
- **[富文本编辑器指南](./rich-text-editor-guide.md)** - 富文本编辑器使用说明
- **[富文本编辑器说明](./rich-text-editor-readme.md)** - 编辑器技术实现详解
- **[卡片编辑器指南](./card-editor-guide.md)** - 卡片式编辑器使用指南

### 🎥 媒体处理
- **[视频解决方案指南](./video-solution-guide.md)** - 视频功能实现方案
- **[视频图片修复指南](./video-image-fix-guide.md)** - 媒体文件问题解决方案

## 🚀 快速开始

### 新开发者入门
1. 首先阅读 **[项目结构文档](./project-structure.md)** 了解项目组织
2. 查看 **[技术架构文档](./technical-architecture.md)** 理解技术选型
3. 参考 **[环境配置文档](./environment-config.md)** 搭建开发环境
4. 阅读 **[功能文档](./feature-documentation.md)** 了解业务逻辑

### 功能开发者
1. 查看 **[功能文档](./feature-documentation.md)** 了解现有功能
2. 参考 **[API接口文档](./api-documentation.md)** 进行接口开发
3. 根据需要查看相应的专项指南

### 产品和测试人员
1. 阅读 **[需求文档](./requirements.md)** 了解产品需求
2. 查看 **[功能文档](./feature-documentation.md)** 了解功能实现
3. 参考各种使用指南进行功能测试

## 📊 项目统计

### 技术栈
- **前端**: 微信小程序原生框架
- **后端**: Node.js / Python / Java (可选)
- **数据库**: MySQL / MongoDB
- **缓存**: Redis
- **文件存储**: 腾讯云COS / 阿里云OSS

### 功能模块
- 🏠 **主页模块**: 资讯展示、快速导航
- 📚 **课程模块**: 课程学习、进度跟踪
- 📰 **文章模块**: 资讯浏览、互动功能
- 👤 **用户模块**: 个人中心、学习统计
- ✏️ **编辑模块**: 内容创作、富文本编辑
- 🛡️ **管理模块**: 后台管理、内容审核

### 页面统计
- **总页面数**: 27个页面
- **主要功能页面**: 15个
- **管理后台页面**: 12个
- **工具函数**: 4个核心工具文件

## 🔍 功能亮点

### 核心功能
- **智能资讯推荐**: 基于用户兴趣的个性化推荐
- **互动式学习**: 视频课程 + 实时进度跟踪
- **富文本编辑**: 强大的内容创作工具
- **社区互动**: 点赞、收藏、分享功能

### 技术亮点
- **响应式设计**: 适配各种屏幕尺寸
- **离线支持**: 关键功能离线可用
- **性能优化**: 懒加载、缓存策略
- **安全保障**: 多层安全防护机制

## 📈 开发进度

### 已完成功能
- ✅ 基础架构搭建
- ✅ 用户登录认证系统（JWT + 微信小程序登录）
- ✅ MyBatis-Plus数据库集成
- ✅ 文章模块开发
- ✅ 富文本编辑器
- ✅ 管理后台基础功能

### 开发中功能
- 🔄 课程视频播放
- 🔄 支付系统集成
- 🔄 推送通知功能
- 🔄 数据统计分析

### 计划功能
- 📅 AI智能推荐
- 📅 多端同步
- 📅 直播功能
- 📅 社区论坛

## 🤝 贡献指南

### 文档贡献
- 发现文档错误或不完整时，请提交Issue或PR
- 新增功能时，请同步更新相关文档
- 遵循文档格式规范，保持一致性

### 代码贡献
- 遵循项目代码规范
- 提交前请进行充分测试
- 重要功能请添加单元测试
- 提交信息请遵循规范格式

## 📞 联系方式

### 技术支持
- 项目仓库: [GitHub链接]
- 技术讨论: [技术群组]
- 问题反馈: [Issue页面]

### 项目团队
- **项目负责人**: [负责人信息]
- **技术负责人**: [技术负责人信息]
- **产品负责人**: [产品负责人信息]

## 📝 更新日志

### 2024-12-19
- 实现完整的用户登录认证系统
- 集成Spring Boot + MyBatis-Plus后端架构
- 完成微信小程序登录功能
- 添加JWT令牌认证和会话管理
- 新增用户登录功能指南文档
- 创建故障排除指南，解决环境配置问题
- 更新.cursorrules文件，添加项目需求处理规范
- 修复app.js中Mock数据在生产环境的问题
- **修复数据库access_token字段长度不足问题（VARCHAR(200) -> VARCHAR(512)）**
- **新增数据库迁移脚本和自动修复工具**
- **解决JWT token过长导致的数据截断错误**
- **修复MyBatis-Plus软删除配置导致的SQL语法错误**
- **移除全局逻辑删除配置，改为手动处理软删除**
- **创建软删除修复脚本和迁移工具**
- **修复session_key重复约束冲突问题**
- **添加防重复插入逻辑，避免微信session_key重复**
- **创建session_key重复清理脚本和迁移工具**
- **登录交互优化**
  - 修复首次登录需要点击两次的问题
  - 优化登录成功后的状态更新逻辑，立即更新页面状态
  - 减少用户等待时间，提升登录体验流畅度
  - 修复环境切换后URL错误的问题
  - 添加baseUrl配置有效性检查，防止无效请求
  - 改进调试面板界面，提供更清晰的操作选项
  - 更新故障排除指南，添加新问题的解决方案
- **技术改进**
  - 优化profile和course页面的登录逻辑
  - 增强auth.js的错误处理和配置验证
  - 改进debug.js的环境切换功能
- **用户体验提升**
  - 登录响应更加及时
  - 环境切换更加可靠
  - 错误提示更加明确

### 2024-03-15
- 完成项目基础文档编写
- 添加功能流程图和架构图
- 完善API接口文档
- 新增MySQL数据库设计文档

### 2024-03-12
- 初始化项目文档结构
- 编写项目需求文档
- 设计技术架构方案

### 环境配置重构
- 重新设计环境配置架构，提供更清晰的环境区分
- 将 `development` 环境重命名为 `mock` 模式，更直观地表示数据来源
- 统一用户模式切换功能，Mock和生产环境都支持管理员/开发者模式切换
- 新增 `config.isMock()` 和 `config.getEnvironmentDescription()` 方法
- 保持 `config.isDevelopment()` 兼容性，映射到 `config.isMock()`
- 优化长按头像功能，提供统一的用户类型切换和调试面板入口
- 更新所有相关文件以使用新的环境配置API
- 改进调试面板界面，提供更清晰的环境状态显示

## 🔖 文档版本

- **当前版本**: v1.0.0
- **最后更新**: 2024-03-15
- **维护状态**: 活跃维护中

## 📚 扩展阅读

### 相关技术文档
- [微信小程序官方文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [微信小程序组件库](https://developers.weixin.qq.com/miniprogram/dev/component/)
- [微信小程序API参考](https://developers.weixin.qq.com/miniprogram/dev/api/)

### 最佳实践
- [小程序性能优化指南](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/)
- [小程序安全指南](https://developers.weixin.qq.com/miniprogram/dev/framework/security.html)
- [小程序开发规范](https://developers.weixin.qq.com/miniprogram/dev/framework/dev-standards/)

---

*本文档持续更新中，如有疑问请联系项目团队。*

**登录状态显示优化**
- 修复个人中心页面登录状态显示问题
- 实现基于`isLogin`状态的条件渲染，已登录和未登录显示不同内容
- 添加未登录状态下的登录入口和访客功能菜单
- 新增`onWechatLogin`、`onSkipLogin`等登录相关方法
- 优化用户体验，未登录时提供明确的操作指引

**Mock数据系统修复**
- 修复Mock模式下课程列表无法加载的问题
- 改进`mockData.js`中的URL匹配逻辑，支持`/api`前缀
- 增强Mock数据调试信息，便于问题排查
- 确保Mock和生产模式下数据访问的一致性
- 完善错误处理机制，提供详细的错误信息

**退出登录URL错误修复**
- 修复auth.js中logout方法的URL配置错误，正确使用`config.getCurrentConfig().baseUrl`
- 修复refreshAccessToken方法中类似的URL配置问题
- 添加Mock模式下的退出登录处理，直接清除本地数据无需网络请求
- 增强配置有效性检查，防止undefined URL导致的请求失败
- 优化页面退出登录逻辑，提供更好的错误处理和用户反馈
- 确保即使网络请求失败也能正常清除本地登录状态 