# 卡片编辑器使用指南

## 概述
卡片编辑器是Miracle Agility小程序中用于创建和编辑课时内容的核心工具。它提供了直观的卡片式编辑界面，支持多种内容类型，并具备草稿保存功能。

## 功能特性

### 1. 内容卡片类型
- **文本卡片**: 支持标题和正文内容
- **图片卡片**: 支持图片上传和描述
- **视频卡片**: 支持视频上传和播放配置
- **重点卡片**: 支持要点列表展示

### 2. 编辑器模式
- **课时编辑模式**: 创建或编辑课时内容
- **章节编辑模式**: 创建章节内容
- **子章节编辑模式**: 编辑子章节内容

### 3. 保存选项
- **保存草稿**: 将未完成的内容保存为草稿状态
- **直接发布**: 完成内容并立即发布
- **预览功能**: 实时预览编辑效果

## 使用流程

### 新增课时
1. 从章节管理页面点击"新增课时"
2. 填写课时基本信息
   - 课时标题（必填）
   - 课时简介（可选）
   - 预计时长（可选）
3. 添加内容卡片
   - 点击右下角"+"按钮
   - 选择卡片类型
   - 填写卡片内容
4. 选择保存方式
   - **保存草稿**: 仅保存，不发布
   - **创建课时**: 保存并发布

### 编辑已有课时
1. 从章节管理页面点击"编辑课时"
2. 修改课时信息和内容卡片
3. 点击"更新课时"保存修改

## 保存草稿功能详解

### 功能说明
保存草稿功能允许用户在内容尚未完成时将其保存，稍后继续编辑。这对于需要分多次完成的复杂课时内容特别有用。

### 使用条件
- 仅在新增课时模式下可用
- 编辑已有课时时不显示草稿按钮
- 必须填写课时标题才能保存草稿

### 操作步骤
1. 在新增课时页面填写课时标题
2. 可选择性添加简介和内容卡片
3. 点击"保存草稿"按钮
4. 系统提示保存成功
5. 自动返回章节管理页面

### 草稿状态
- 草稿课时在章节管理页面显示为未发布状态
- 可以通过编辑功能继续完善草稿内容
- 草稿可以随时转为正式发布状态

## 按钮说明

### 底部工具栏按钮
- **预览**: 查看当前编辑内容的效果
- **清空**: 清除所有内容（需确认）
- **保存草稿**: 保存为草稿状态（仅新增模式）
- **创建课时/更新课时**: 保存并发布

### 按钮显示逻辑
```javascript
// 新增课时模式：显示4个按钮
[预览] [清空] [保存草稿] [创建课时]

// 编辑课时模式：显示3个按钮
[预览] [清空] [更新课时]
```

## 内容卡片操作

### 添加卡片
1. 点击右下角蓝色"+"按钮
2. 从弹出菜单选择卡片类型
3. 填写相应的内容字段

### 编辑卡片
- 直接在卡片区域修改内容
- 支持实时编辑和保存

### 删除卡片
1. 点击卡片右上角的删除按钮
2. 确认删除操作

### 调整顺序
- 使用卡片上的上移/下移按钮
- 调整卡片在课时中的显示顺序

## 预览功能

### 预览内容
- 课时基本信息（标题、描述等）
- 所有内容卡片的渲染效果
- 媒体文件的播放预览

### 预览操作
1. 点击"预览"按钮
2. 在弹出的模态框中查看效果
3. 支持滚动查看完整内容
4. 点击"×"关闭预览

## 错误处理

### 常见错误
- **标题未填写**: 提示"请输入课时标题"
- **网络请求失败**: 显示具体错误信息
- **文件上传失败**: 提供重试选项

### 解决方案
- 检查网络连接
- 确认必填字段已填写
- 重试失败的操作
- 联系技术支持

## 技术实现

### 文件结构
```
pages/card-editor/
├── card-editor.js      # 核心逻辑
├── card-editor.wxml    # 界面布局
├── card-editor.wxss    # 样式定义
└── card-editor.json    # 页面配置
```

### 关键方法
- `saveDraft()`: 保存草稿功能
- `saveLesson()`: 保存并发布课时
- `addCard()`: 添加内容卡片
- `showPreview()`: 显示预览

### API接口
- `POST /api/lessons/create`: 创建课时（包括草稿）
- `PUT /api/lessons/{id}`: 更新课时
- `POST /api/file/upload`: 上传媒体文件

## 最佳实践

### 内容组织
- 合理使用不同类型的卡片
- 保持内容结构清晰
- 适当使用重点卡片突出要点

### 草稿管理
- 及时保存重要内容
- 定期整理和发布草稿
- 避免积累过多未完成的草稿

### 性能优化
- 控制单个课时的卡片数量
- 优化图片和视频文件大小
- 合理使用预览功能

## 故障排除

### 页面无响应
1. 检查网络连接
2. 刷新页面重试
3. 清除小程序缓存

### 保存失败
1. 检查必填字段
2. 确认网络状态
3. 重试保存操作

### 媒体文件问题
1. 检查文件格式和大小
2. 确认上传权限
3. 使用其他文件重试

## 更新日志

### v1.2.0 (2024-01-XX)
- 新增保存草稿功能
- 优化底部工具栏布局
- 改进错误处理机制
- 更新按钮文字显示

### v1.1.0 (2024-01-XX)
- 支持多种内容卡片类型
- 添加预览功能
- 实现卡片排序功能

### v1.0.0 (2024-01-XX)
- 基础编辑器功能
- 支持文本和图片卡片
- 基本的保存和发布功能 